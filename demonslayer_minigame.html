<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¬¼æ»…ä¹‹åˆƒï¼šé¬¼æ®ºéšŠäººç”Ÿå¤§å¯Œç¿</title>
    <style>
        :root {
            --bg-color: #2c2c2c;
            --board-bg: #f4e4bc; /* æ¦»æ¦»ç±³è‰² */
            --p1-color: #2ecc71; /* ç‚­æ²»éƒç¶  */
            --p2-color: #f1c40f; /* å–„é€¸é»ƒ */
            --danger: #e74c3c;
            --text: #333;
        }
        body {
            font-family: 'Microsoft JhengHei', sans-serif;
            background-color: var(--bg-color);
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            padding: 20px;
        }
        h1 { margin-bottom: 10px; text-shadow: 2px 2px 4px #000; }
        
        /* éŠæˆ²é¢æ¿ä½ˆå±€ */
        .game-container {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        /* åœ°åœ–è¨­è¨ˆ */
        .board {
            display: grid;
            grid-template-columns: repeat(5, 80px);
            grid-template-rows: repeat(5, 80px);
            gap: 5px;
            background: #5d4037;
            padding: 10px;
            border-radius: 10px;
            border: 4px solid #ecf0f1;
        }

        .cell {
            background-color: var(--board-bg);
            color: var(--text);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            text-align: center;
            border-radius: 4px;
            position: relative;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.1);
            font-weight: bold;
        }

        /* ç‰¹æ®Šæ ¼å­é¡è‰² */
        .cell.start { background: #fff; border: 2px solid gold; }
        .cell.safe { background: #d5f5e3; } /* è¶å±‹ */
        .cell.danger { background: #fadbd8; } /* é¬¼å‡ºæ²’ */
        .cell.bonus { background: #d6eaf8; } /* é›åˆ€æ‘ */

        /* ç©å®¶æ¨™è¨˜ */
        .player-token {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            position: absolute;
            bottom: 5px;
            transition: all 0.3s ease;
            box-shadow: 1px 1px 3px rgba(0,0,0,0.5);
            z-index: 10;
        }
        .p1-token { background: var(--p1-color); border: 2px solid #000; left: 20%; content: "ç‚­"; }
        .p2-token { background: var(--p2-color); border: 2px solid #000; right: 20%; }

        /* æ§åˆ¶å°èˆ‡è³‡è¨Š */
        .info-panel {
            background: rgba(0, 0, 0, 0.8);
            padding: 20px;
            border-radius: 10px;
            width: 300px;
        }

        .stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            padding: 10px;
            background: #444;
            border-radius: 5px;
        }

        .stat-box { text-align: center; }
        .stat-value { font-size: 1.2em; font-weight: bold; }

        button {
            background: #e67e22;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            width: 100%;
            border-radius: 5px;
            margin-bottom: 10px;
            transition: 0.2s;
        }
        button:hover { background: #d35400; }
        button:disabled { background: #7f8c8d; cursor: not-allowed; }

        #log {
            height: 150px;
            overflow-y: auto;
            background: #222;
            padding: 10px;
            border: 1px solid #555;
            font-size: 14px;
            color: #ddd;
            margin-top: 10px;
        }
        .log-entry { margin-bottom: 5px; border-bottom: 1px solid #333; padding-bottom: 2px; }
        .log-p1 { color: var(--p1-color); }
        .log-p2 { color: var(--p2-color); }
        .log-danger { color: #ff6b6b; }

        /* æ ¼å­æ’åˆ—é‚è¼¯ (ç¹åœˆåœˆ) */
        .cell:nth-child(1) { grid-area: 1 / 1 / 2 / 2; }
        .cell:nth-child(2) { grid-area: 1 / 2 / 2 / 3; }
        .cell:nth-child(3) { grid-area: 1 / 3 / 2 / 4; }
        .cell:nth-child(4) { grid-area: 1 / 4 / 2 / 5; }
        .cell:nth-child(5) { grid-area: 1 / 5 / 2 / 6; }
        .cell:nth-child(6) { grid-area: 2 / 5 / 3 / 6; }
        .cell:nth-child(7) { grid-area: 3 / 5 / 4 / 6; }
        .cell:nth-child(8) { grid-area: 4 / 5 / 5 / 6; }
        .cell:nth-child(9) { grid-area: 5 / 5 / 6 / 6; }
        .cell:nth-child(10) { grid-area: 5 / 4 / 6 / 5; }
        .cell:nth-child(11) { grid-area: 5 / 3 / 6 / 4; }
        .cell:nth-child(12) { grid-area: 5 / 2 / 6 / 3; }
        .cell:nth-child(13) { grid-area: 5 / 1 / 6 / 2; }
        .cell:nth-child(14) { grid-area: 4 / 1 / 5 / 2; }
        .cell:nth-child(15) { grid-area: 3 / 1 / 4 / 2; }
        .cell:nth-child(16) { grid-area: 2 / 1 / 3 / 2; }

        /* ä¸­å¤®è£é£¾ */
        .center-deco {
            grid-area: 2 / 2 / 5 / 5;
            background-image: url('https://upload.wikimedia.org/wikipedia/commons/thumb/6/69/Japanese_pattern_checkerboard.svg/1200px-Japanese_pattern_checkerboard.svg.png');
            background-size: cover;
            opacity: 0.3;
            display: flex;
            align-items: center;
            justify-content: center;
            color: rgba(255,255,255,0.8);
            font-size: 2em;
            font-weight: bold;
            writing-mode: vertical-rl;
        }

    </style>
</head>
<body>

    <h1>ğŸ—¡ï¸ é¬¼æ®ºéšŠï¼šç”Ÿå­˜å¤§å¯Œç¿</h1>

    <div class="game-container">
        <div class="board" id="board">
            <div class="center-deco">æƒ¡é¬¼æ»…æ®º</div>
        </div>

        <div class="info-panel">
            <h3>ç›®å‰å›åˆ: <span id="current-turn" style="color:var(--p1-color)">ç‚­æ²»éƒ</span></h3>
            
            <div class="stats">
                <div class="stat-box">
                    <div style="color:var(--p1-color)">ğŸŒŠ ç‚­æ²»éƒ</div>
                    <div>HP: <span id="p1-hp">100</span></div>
                    <div>æ—¥åœ“: <span id="p1-money">1000</span></div>
                </div>
                <div class="stat-box">
                    <div style="color:var(--p2-color)">âš¡ å–„é€¸</div>
                    <div>HP: <span id="p2-hp">100</span></div>
                    <div>æ—¥åœ“: <span id="p2-money">1000</span></div>
                </div>
            </div>

            <button id="roll-btn" onclick="playTurn()">æ“²éª°å­ (å‘¼å¸æ³•é‹è½‰)</button>
            <div id="dice-result" style="text-align:center; margin-bottom:10px; height:20px;"></div>

            <div id="log">
                <div class="log-entry">éŠæˆ²é–‹å§‹ï¼ç›®æ¨™ï¼šå­˜æ´»ä¸¦è³ºå– 5000 æ—¥åœ“ã€‚</div>
            </div>
        </div>
    </div>

    <script>
        // éŠæˆ²è¨­å®š
        const mapData = [
            { name: "èµ·é»", type: "start", effect: 0 },
            { name: "ç‹¹éœ§å±±", type: "safe", desc: "é±—ç€§å¸«çˆ¶ç‰¹è¨“ï¼ŒHP+10", val: 10 },
            { name: "æ²¼æ¾¤é¬¼", type: "danger", desc: "é­é‡ç•°èƒ½é¬¼ï¼HP-15", val: 15 },
            { name: "æ·ºè‰", type: "bonus", desc: "é‡è¦‹ç ä¸–å°å§ï¼Œç²å¾—è—¥æ°´ï¼Œæ—¥åœ“+200", val: 200 },
            { name: "é¼“ä¹‹å®…é‚¸", type: "danger", desc: "ç©ºé–“è¿´è½‰ï¼Œæšˆçœ© HP-10", val: 10 },
            { name: "è—¤ä¹‹å®¶", type: "safe", desc: "ç´«è—¤èŠ±å®¶ç´‹ä¼‘æ¯ï¼ŒHPå…¨æ»¿", val: 999 },
            { name: "é‚£ç”°èœ˜è››å±±", type: "danger", desc: "å°æˆ°ä¸‹å¼¦ä¹‹ä¼ï¼HP-30", val: 30 },
            { name: "é¹é´‰ä»»å‹™", type: "bonus", desc: "å®Œæˆå‚³ä»¤ä»»å‹™ï¼Œæ—¥åœ“+300", val: 300 },
            { name: "ç„¡é™åˆ—è»Š", type: "danger", desc: "å¤¢å¢ƒæ·±æ·µï¼Œæ—¥åœ“-200 (è²·ç¥¨)", val: -200 },
            { name: "ç…‰ç„å®¶", type: "safe", desc: "ç‚æŸ±çš„ç†±æƒ…ï¼Œæ”»æ“ŠåŠ›UP(è±¡å¾µæ€§)", val: 0 },
            { name: "å‰åŸéŠéƒ­", type: "danger", desc: "å¢®å§¬ä¾†è¥²ï¼HP-25", val: 25 },
            { name: "é›åˆ€æ‘", type: "bonus", desc: "é‹¼éµå¡šç£¨åˆ€ï¼Œæ—¥åœ“-100 ä½† HP+20", val: -100 }, // ç‰¹æ®Šé‚è¼¯å¯«åœ¨JS
            { name: "æŸ±åˆæœƒè­°", type: "bonus", desc: "ä¸»å…¬è³è³œï¼Œæ—¥åœ“+500", val: 500 },
            { name: "ç„¡é™åŸ", type: "danger", desc: "é­é‡ä¸Šå¼¦ï¼HP-40", val: 40 },
            { name: "ç”¢å±‹æ•·", type: "safe", desc: "çµ•å°å®‰å…¨å€ï¼ŒHP+10", val: 10 },
            { name: "æœ€çµ‚é¸æ‹”", type: "danger", desc: "æ‰‹é¬¼è¥²æ“Šï¼ŒHP-20", val: 20 }
        ];

        const players = [
            { id: 1, name: "ç‚­æ²»éƒ", pos: 0, hp: 100, money: 1000, color: "var(--p1-color)", icon: "ğŸŒŠ" },
            { id: 2, name: "å–„é€¸", pos: 0, hp: 100, money: 1000, color: "var(--p2-color)", icon: "âš¡" } // é›»è…¦
        ];

        let currentPlayerIndex = 0;
        let isGameOver = false;

        // åˆå§‹åŒ–åœ°åœ–
        function initBoard() {
            const board = document.getElementById('board');
            // ç§»é™¤é™¤äº† center-deco ä»¥å¤–çš„å…ƒç´ 
            const deco = document.querySelector('.center-deco');
            board.innerHTML = '';
            board.appendChild(deco);

            mapData.forEach((data, index) => {
                const cell = document.createElement('div');
                cell.className = `cell ${data.type}`;
                cell.innerHTML = `<div>${data.name}</div>`;
                
                // é€™ç¨®æ’ç‰ˆæ˜¯ç‚ºäº†é…åˆ grid-areaï¼Œç¢ºä¿æ˜¯ç¹åœˆåœˆ
                // é€™è£¡æˆ‘å€‘ç”¨ JS ç°¡å–®å‹•æ…‹ç”Ÿæˆ grid-area å¤ªè¤‡é›œï¼Œç›´æ¥ç”¨ CSS å¯«æ­»çš„é †åº
                // æ‰€ä»¥ DOM é †åºå¿…é ˆç¬¦åˆ CSS nth-child çš„é †åº
                board.appendChild(cell);
            });

            // åˆå§‹åŒ–ç©å®¶ä½ç½®
            updatePlayerTokens();
        }

        function updatePlayerTokens() {
            // æ¸…é™¤èˆŠçš„ token
            document.querySelectorAll('.player-token').forEach(el => el.remove());
            
            players.forEach((p, idx) => {
                const cellIndex = p.pos;
                // CSS nth-child æ˜¯å¾ 1 é–‹å§‹ï¼Œä¸”æˆ‘å€‘æœ‰ center-deco åœ¨è£¡é¢ï¼Œæ‰€ä»¥è¦å°å¿ƒ
                // ç°¡å–®è§£æ³•ï¼šæˆ‘å€‘åœ¨ board è£¡æŠ“ .cell
                const cells = document.querySelectorAll('.cell');
                const targetCell = cells[cellIndex];

                const token = document.createElement('div');
                token.className = `player-token p${p.id}-token`;
                
                // ç¨å¾®éŒ¯é–‹ä½ç½®é¿å…é‡ç–Š
                if(idx === 0) token.style.left = "10px";
                if(idx === 1) token.style.right = "10px";

                targetCell.appendChild(token);
            });
        }

        function log(msg, type="") {
            const logDiv = document.getElementById('log');
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.innerText = msg;
            logDiv.prepend(entry); // æ–°è¨Šæ¯åœ¨æœ€ä¸Šé¢
        }

        function updateStats() {
            document.getElementById('p1-hp').innerText = players[0].hp;
            document.getElementById('p1-money').innerText = players[0].money;
            document.getElementById('p2-hp').innerText = players[1].hp;
            document.getElementById('p2-money').innerText = players[1].money;
        }

        function checkWinCondition() {
            const p1 = players[0];
            const p2 = players[1];

            if (p1.hp <= 0) {
                alert("ç‚­æ²»éƒåŠ›ç«­å€’ä¸‹äº†... å–„é€¸ç²å‹ï¼");
                isGameOver = true;
                return true;
            }
            if (p2.hp <= 0) {
                alert("å–„é€¸åš‡æšˆäº†... ç‚­æ²»éƒç²å‹ï¼");
                isGameOver = true;
                return true;
            }
            if (p1.money >= 5000) {
                alert("ç‚­æ²»éƒç±Œå¤ äº†è³‡é‡‘ï¼Œæˆç‚ºäº†æŸ±ï¼ç²å‹ï¼");
                isGameOver = true;
                return true;
            }
            if (p2.money >= 5000) {
                alert("å–„é€¸è³ºå¤ äº†éŒ¢å»å¨¶ç¦°è±†å­(èª¤)ï¼ç²å‹ï¼");
                isGameOver = true;
                return true;
            }
            return false;
        }

        function playTurn() {
            if (isGameOver) return;

            const btn = document.getElementById('roll-btn');
            btn.disabled = true;
            const player = players[currentPlayerIndex];
            
            // 1. æ“²éª°å­
            const dice = Math.floor(Math.random() * 6) + 1;
            document.getElementById('dice-result').innerText = `${player.icon} ${player.name} æ“²å‡ºäº† ${dice} é»`;
            
            // 2. ç§»å‹•
            player.pos = (player.pos + dice) % mapData.length;
            
            // å¦‚æœç¶“éèµ·é» (ç°¡å–®é‚è¼¯ï¼šå¦‚æœæ–°ä½ç½®æ¯”èˆŠä½ç½®å°ï¼Œä¸”ä¸æ˜¯å‰›é–‹å§‹)
            // é€™è£¡ç°¡åŒ–ï¼šæ¯æ¬¡è¸©åˆ°æˆ–ç¶“éèµ·é»çµ¦çå‹µå¤ªè¤‡é›œï¼Œç›´æ¥çœ‹æ ¼å­æ•ˆæœ

            updatePlayerTokens();

            // 3. è§¸ç™¼æ•ˆæœ
            const cell = mapData[player.pos];
            const logClass = player.id === 1 ? "log-p1" : "log-p2";
            
            setTimeout(() => {
                log(`${player.name} åˆ°é”äº† ã€${cell.name}ã€‘`, logClass);
                
                if (cell.type === 'danger') {
                    player.hp -= cell.val;
                    log(`âš  ${cell.desc} (HP -${cell.val})`, "log-danger");
                } else if (cell.type === 'safe') {
                    if (cell.val === 999) player.hp = 100;
                    else player.hp = Math.min(100, player.hp + cell.val);
                    log(`ğŸ’š ${cell.desc}`, logClass);
                } else if (cell.type === 'bonus') {
                    // ç‰¹æ®Šè™•ç†é›åˆ€æ‘
                    if (cell.name === "é›åˆ€æ‘") {
                        player.money -= 100;
                        player.hp = Math.min(100, player.hp + 20);
                        log(`ğŸ”¨ ${cell.desc} (æ—¥åœ“-100, HP+20)`, logClass);
                    } else {
                        player.money += cell.val;
                        log(`ğŸ’° ${cell.desc} (æ—¥åœ“ +${cell.val})`, logClass);
                    }
                } else if (cell.name === "ç„¡é™åˆ—è»Š") {
                     // ç‰¹æ®Šè² éŒ¢
                     player.money += cell.val; // val is negative
                     log(`ğŸš‚ ${cell.desc}`, "log-danger");
                }

                updateStats();

                if (checkWinCondition()) {
                    btn.innerText = "éŠæˆ²çµæŸ";
                    return;
                }

                // æ›äºº
                currentPlayerIndex = (currentPlayerIndex + 1) % players.length;
                const nextPlayer = players[currentPlayerIndex];
                document.getElementById('current-turn').innerText = nextPlayer.name;
                document.getElementById('current-turn').style.color = nextPlayer.color;

                // å¦‚æœä¸‹ä¸€ä½æ˜¯é›»è…¦(å–„é€¸)ï¼Œè‡ªå‹•åŸ·è¡Œ
                if (nextPlayer.id === 2) {
                    btn.innerText = "å–„é€¸æ€è€ƒä¸­...";
                    setTimeout(() => {
                        playTurn();
                        if(!isGameOver) btn.innerText = "æ“²éª°å­ (å‘¼å¸æ³•é‹è½‰)";
                        btn.disabled = false;
                    }, 1500);
                } else {
                    btn.disabled = false;
                }

            }, 500); // ç§»å‹•å‹•ç•«å»¶é²
        }

        // å•Ÿå‹•
        initBoard();
    </script>
</body>
</html>